<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Registrations Report - <%= activity.title %></title>
  <style>
    body { font-family: Arial, sans-serif; color: #222; margin: 20px; }
    header { text-align: center; margin-bottom: 10px; }
    h1 { margin: 0; font-size: 20px; }
    .meta { font-size: 12px; color: #555; margin-bottom: 12px; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #ddd; padding: 8px; font-size: 12px; }
    th { background: #f7f7f7; text-align: left; }
    .small { font-size: 11px; color: #666; }
    footer { margin-top: 18px; font-size: 11px; color: #777; text-align: right; }
  </style>
</head>
<body>
  <header>
    <h1>รายงานผู้ลงทะเบียน: <%= activity.title %></h1>
    <div class="meta">
      Activity ID: <%= activity.id %> &nbsp;|&nbsp;
      สถานที่: <%= activity.location || '-' %> &nbsp;|&nbsp;
      ระยะเวลา: <%= activity.startDateStr %> - <%= activity.endDateStr %>
    </div>
    <div class="meta">Generated: <%= nowStr %> | Total registrations: <%= rows.length %></div>
  </header>

  <table>
    <thead>
      <tr>
        <th style="width:5%;">#</th>
        <th style="width:20%;">ชื่อ</th>
        <th style="width:25%;">อีเมล</th>
        <th style="width:15%;">สถานะ</th>
        <th style="width:25%;">วันที่ลงทะเบียน</th>
      </tr>
    </thead>
    <tbody>
      <% rows.forEach(function(r, idx) { %>
        <tr>
          <td><%= idx+1 %></td>
          <td><%= r.userName || '-' %></td>
          <td><%= r.userEmail || '-' %></td>
          <td><%= r.status %></td>
          <td class="small"><%= r.registeredAt %></td>
        </tr>
      <% }); %>
      <% if (!rows.length) { %>
        <tr><td colspan="5" style="text-align:center; color:#999;">ไม่มีข้อมูลการลงทะเบียน</td></tr>
      <% } %>
    </tbody>
  </table>

  <footer>my-activity-backend &nbsp;|&nbsp; Generated by system</footer>
</body>
</html>
